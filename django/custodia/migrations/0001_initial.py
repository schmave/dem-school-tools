# Generated by Django 5.1.5 on 2025-02-11 02:07

from django.db import migrations


class Migration(migrations.Migration):
    dependencies = []

    operations = [
        # This has to be run before the django.contrib.admin migrations. If
        # not, then the django_admin_log table will reference overseer.users
        # instead of public.users.
        migrations.RunSQL(
            "ALTER TABLE overseer.users rename to old_users",
            "ALTER TABLE overseer.old_users rename to users",
        ),
        # Add fields needed for django auth/user
        migrations.RunSQL("""
ALTER TABLE public.users ADD COLUMN date_joined timestamptz NOT NULL default '2000-01-01';
ALTER TABLE public.users ADD COLUMN last_login timestamptz NULL default NULL;
ALTER TABLE public.users ADD COLUMN first_name varchar(150) NOT NULL default '';
ALTER TABLE public.users ADD COLUMN last_name varchar(150) NOT NULL default '';
ALTER TABLE public.users ADD COLUMN is_superuser bool NOT NULL default false;
ALTER TABLE public.users ADD COLUMN is_staff bool NOT NULL default false;
ALTER TABLE public.users ADD COLUMN is_active bool NOT NULL default true;
ALTER TABLE public.users ADD COLUMN username varchar(150) NOT NULL default '';
"""),
        # Set late_time at the school level instead of class level
        migrations.RunSQL("""
alter table overseer.schools add column late_time time DEFAULT '10:15:00'::time without time zone NULL;
"""),
        # Add unique ID to students_required_minutes table
        migrations.RunSQL("""
ALTER TABLE overseer.students_required_minutes ADD COLUMN id SERIAL PRIMARY KEY;
"""),
    ]
